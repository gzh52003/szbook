(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e0c91a8e"],{"2bb5":function(e,t,o){},"38b9":function(e,t,o){"use strict";var n=o("2bb5"),a=o.n(n);a.a},"712d":function(e,t,o){"use strict";o.r(t);var n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{attrs:{id:"shopCart"}},[o("order-module",{attrs:{text:"购物车"},scopedSlots:e._u([{key:"headerIcon",fn:function(){return[o("van-icon",{attrs:{name:"delete"},on:{click:e.deleteGoods}})]},proxy:!0},{key:"content",fn:function(){return[0==e.cartInfolist.length?o("van-empty",{staticClass:"custom-image",attrs:{image:"https://img.yzcdn.cn/vant/custom-empty-image.png",description:"您的购物车还没有商品哦，赶快去选购吧"}}):e._e(),e._l(e.cartInfolist,(function(t,n){return o("van-card",{key:n,staticClass:"van-multi-ellipsis--l2",attrs:{num:t.num,price:t.book.line_price,desc:t.book.desc,title:t.book.bookName,thumb:"./images/szbookApp/"+t.book.img}},[o("template",{slot:"footer"},[o("span",{staticStyle:{"vertical-align":"middle",float:"left"}},[e._v("总价：￥"+e._s(e.perTotalPrice(t)))]),o("van-stepper",{staticStyle:{display:"inline-block"},attrs:{"input-width":"3vw","button-size":"5vw",value:t.num,integer:""},on:{change:function(o){return e.onChange(o,t.book.bookName)}}})],1),o("template",{slot:"tag"},[o("van-checkbox",{staticClass:"agree",attrs:{"checked-color":"#000","icon-size":"18px"},on:{change:function(o){return e.changeCheck(t.checked,t.book.bookName)}},model:{value:t.checked,callback:function(o){e.$set(t,"checked",o)},expression:"item.checked"}})],1)],2)}))]},proxy:!0}])}),o("van-submit-bar",{attrs:{price:100*e.totalPrice,"button-text":"提交订单"},on:{submit:e.onSubmit}},[o("van-checkbox",{model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}},[e._v("全选")])],1)],1)},a=[],s=(o("a623"),o("4de4"),o("a15b"),o("d81d"),o("b680"),o("d3b7"),o("ac1f"),o("1276"),o("9a83"),o("f564")),r=(o("e17f"),o("2241")),c=(o("be39"),o("efa0")),i=(o("3c32"),o("417e")),u=(o("f06a"),o("20fb")),f=(o("91d5"),o("f0ca")),l=(o("9cb7"),o("66fd")),m=(o("81e6"),o("9ffb")),h=(o("4d48"),o("d1e1")),d=(o("1f87"),o("510b")),b=o("2b0e"),p=o("f9a7");b["a"].use(d["a"]),b["a"].use(h["a"]),b["a"].use(m["a"]),b["a"].use(l["a"]),b["a"].use(f["a"]),b["a"].use(u["a"]),b["a"].use(i["a"]),b["a"].use(c["a"]),b["a"].use(r["a"]),b["a"].use(s["a"]);var g={data:function(){return{checked:!1,imageURL:"https://img.yzcdn.cn/vant/cat.jpeg"}},computed:{cartInfolist:function(){return this.$store.state.userInfo.cartInfo},totalPrice:function(){return this.$store.getters.totalPrice},checkAll:{get:function(){var e=this.$store.state.userInfo.cartInfo.filter((function(e){return e.checked}));return 0!==e.length&&this.$store.state.userInfo.cartInfo.every((function(e){return e.checked}))},set:function(e){this.$store.state.userInfo.cartInfo=this.$store.state.userInfo.cartInfo.map((function(t){return t.checked=e,t}))}}},methods:{perTotalPrice:function(e){var t=e.book.line_price.split("");return t.shift(),t=parseFloat(t.join("")),(t*e.num).toFixed(2)},changeCheck:function(e,t){console.log(e,t),this.$store.commit("changeCheck",{ischeck:e,bookName:t}),localStorage.setItem("szbookcarInfo",JSON.stringify(this.$store.state.userInfo.cartInfo))},deleteGoods:function(){var e=this,t=this.$store.state.userInfo.cartInfo.filter((function(e){return e.checked}));0!==t.length&&r["a"].confirm({title:"删除商品",message:"是否确认删除商品",theme:"round-button"}).then((function(){Object(s["a"])({type:"success",message:"商品已删除"}),e.$store.commit("deleteGood"),localStorage.setItem("szbookcarInfo",JSON.stringify(e.$store.state.userInfo.cartInfo)),e.$request.patch("/goods",{username:e.$store.state.userInfo.username,cartInfo:e.$store.state.userInfo.cartInfo}).then((function(e){}))})).catch((function(){}))},onSubmit:function(){var e=this,t=this.$store.state.userInfo.cartInfo.filter((function(e){return e.checked}));if(0!==t.length){console.log("submit");var o=t.map((function(t){return t.book.buynum=t.num,t.book.totalPrice=e.totalPrice,t.book}));o=o.map((function(e){return{bookName:e.bookName,author:e.author,public:e.public,isbn:e.isbn,time:e.time,desc:e.desc,price:e.price,line_price:e.line_price,num:e.num,saleNum:e.saleNum,categoryInfo:e.categoryInfo,img:e.img,buynum:e.buynum,totalPrice:e.totalPrice}}));var n=new Date;n=new Date(n);var a=n.getFullYear(),r=n.getMonth()+1,c=n.getDate(),i=n.getHours(),u=n.getMinutes(),f=n.getSeconds();n=[a,r,c].join("-")+" "+[i,u,f].join(":");var l="http://www.ihuanu.cn/api/order";fetch(l,{method:"post",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.$store.state.userInfo.username,add_time:n,address:"深圳市龙岗区",goodsNum:t.length,phone:"13715158094",totalPrice:this.totalPrice,details:o,finished:"false"})}).then((function(e){return e.json()})).then((function(t){console.log(t),0==t.code?Object(s["a"])({type:"danger",message:"下单出错啦，请再次下单"}):1==t.code&&(Object(s["a"])({type:"success",message:"下单成功,您的商品正在向你狂奔"}),e.$store.commit("deleteGood"),localStorage.setItem("szbookcarInfo",JSON.stringify(e.$store.state.userInfo.cartInfo)),e.$request.patch("/goods",{username:e.$store.state.userInfo.username,cartInfo:e.$store.state.userInfo.cartInfo}).then((function(e){})))}))}},onChange:function(e,t){this.$store.commit("changeGoodNum",{willNum:e,bookName:t}),localStorage.setItem("szbookcarInfo",JSON.stringify(this.$store.state.userInfo.cartInfo)),this.$request.patch("/goods",{username:this.$store.state.userInfo.username,cartInfo:this.$store.state.userInfo.cartInfo}).then((function(e){}))}},components:{orderModule:p["a"]}},k=g,I=(o("38b9"),o("2877")),v=Object(I["a"])(k,n,a,!1,null,"0e131dfa",null);t["default"]=v.exports},a623:function(e,t,o){"use strict";var n=o("23e7"),a=o("b727").every,s=o("a640"),r=o("ae40"),c=s("every"),i=r("every");n({target:"Array",proto:!0,forced:!c||!i},{every:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}})}}]);
//# sourceMappingURL=chunk-e0c91a8e.js.map